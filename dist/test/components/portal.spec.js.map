{"version":3,"file":"portal.spec.js","sourceRoot":"","sources":["../../../test/components/portal.spec.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport {ClientRenderer, expect, waitFor} from 'test-drive-react';\nimport {Portal} from '../../src';\nimport {PortalTestDriver} from '../../test-kit';\n\ndescribe('<Portal />', () => {\n    const clientRenderer = new ClientRenderer();\n\n    afterEach(() => {clientRenderer.cleanup(); });\n\n    it('displays the portal and renders its children', async () => {\n        const {result} = clientRenderer.render(\n            <Portal>\n                <span>Portal Body</span>\n            </Portal>);\n\n        const portal = new PortalTestDriver(result as Portal);\n\n        await waitFor(() => {\n            expect(portal.root).to.be.present();\n            expect(portal.content[0]).to.be.present();\n        });\n    });\n\n    it('applies supplied styles to the popup and updates them if changed', async () => {\n        const {container, result} = clientRenderer.render(\n            <Portal style={{position: 'absolute'}}>\n                <span>Portal Body</span>\n            </Portal>\n        );\n\n        const portal = new PortalTestDriver(result as Portal);\n\n        await waitFor(() => expect(portal.root).to.have.nested.property('style.position', 'absolute'));\n\n        clientRenderer.render(\n            <Portal style={{position: 'fixed'}}>\n                <span>Portal Body</span>\n            </Portal>,\n            container\n        );\n\n        await waitFor(() => expect(portal.root).to.have.nested.property('style.position', 'fixed'));\n    });\n\n    it('applies supplied className and id to the popup and updates them if changed', async () => {\n        const {container, result} = clientRenderer.render(\n            <Portal className=\"my-test-class\" id=\"my-test-id\">\n                <span>Portal Body</span>\n            </Portal>\n        );\n\n        const portal = new PortalTestDriver(result as Portal);\n\n        await waitFor(() => expect(portal.root).to.have.nested.property('className', 'my-test-class'));\n        await waitFor(() => expect(portal.root).to.have.nested.property('id', 'my-test-id'));\n\n        clientRenderer.render(\n            <Portal className=\"another-test-class\" id=\"another-test-id\">\n                <span>Portal Body</span>\n            </Portal>,\n            container\n        );\n\n        await waitFor(() => expect(portal.root).to.have.nested.property('className', 'another-test-class'));\n        await waitFor(() => expect(portal.root).to.have.nested.property('id', 'another-test-id'));\n    });\n\n    it('removes the component when unmounting', async () => {\n        const container = document.body.appendChild(document.createElement('div'));\n        const {result} = clientRenderer.render(\n            <Portal>\n                <span>Popup Body</span>\n            </Portal>, container);\n\n        const portal = new PortalTestDriver(result as Portal);\n\n        await waitFor(() => expect(portal.root).to.be.present());\n\n        ReactDOM.unmountComponentAtNode(container);\n        document.body.removeChild(container);\n\n        await waitFor(() => expect(portal.isPresent).to.be.false);\n    });\n\n    it('updates the portal content if the children are changed', async () => {\n        const initialText = 'Portal Body';\n        const updatedText = 'Portal Body Updated';\n        const {container, result} = clientRenderer.render(\n            <Portal>\n                <span>{initialText}</span>\n            </Portal>\n        );\n\n        const portal = new PortalTestDriver(result as Portal);\n\n        await waitFor(() => expect(portal.content[0]).to.have.text(initialText));\n\n        clientRenderer.render(\n            <Portal>\n                <span>{updatedText}</span>\n            </Portal>,\n            container\n        );\n\n        await waitFor(() => expect(portal.content[0]).to.have.text(updatedText));\n    });\n\n    it('renders the portal in the bottom of the DOM', async () => {\n        const {container, result} = clientRenderer.render(\n            <Portal>\n                <span>Portal Body</span>\n            </Portal>\n        );\n\n        const portal = new PortalTestDriver(result as Portal);\n\n        await waitFor(() => {\n            /* tslint:disable:no-bitwise */\n            expect(portal.root.compareDocumentPosition(portal.content[0]) & Node.DOCUMENT_POSITION_CONTAINED_BY,\n                'children contained in portal').to.equal(Node.DOCUMENT_POSITION_CONTAINED_BY);\n            expect(container.compareDocumentPosition(portal.root) & Node.DOCUMENT_POSITION_FOLLOWING,\n                'portal is following the app container').to.equal(Node.DOCUMENT_POSITION_FOLLOWING);\n            /* tslint:enable:no-bitwise */\n        });\n    });\n\n    it('renders with a className passed as a prop', async () => {\n        const {result} = clientRenderer.render(\n            <Portal className=\"test-class\">\n                <span>Portal Body</span>\n            </Portal>\n        );\n\n        const portal = new PortalTestDriver(result as Portal);\n\n        await waitFor(() => expect((portal.root as Element).className).to.contain('test-class'));\n    });\n});\n"]}