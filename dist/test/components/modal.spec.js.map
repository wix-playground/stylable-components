{"version":3,"file":"modal.spec.js","sourceRoot":"","sources":["../../../test/components/modal.spec.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {ClientRenderer, expect, selectDom, simulate, sinon, waitFor} from 'test-drive-react';\nimport {ModalDemo} from '../../demo/components/modal-demo';\nimport {Modal} from '../../src';\n\ndescribe('<Modal />', () => {\n    const clientRenderer = new ClientRenderer();\n    const bodySelect = selectDom(document.body);\n\n    afterEach(() => clientRenderer.cleanup());\n\n    describe('A typical use case for the modal:', () => {\n        it('is hidden at first, a user clicks on a button, the modal appears,' +\n            'and then the user clicks on the background and the model closes', async () => {\n            clientRenderer.render(<ModalDemo />);\n\n            await waitFor(() => expect(bodySelect('MODAL')).to.be.absent());\n\n            simulate.click(bodySelect('MODAL_BUTTON'));\n\n            await waitFor(() => expect(bodySelect('MODAL')).to.be.present());\n\n            simulate.click(bodySelect('MODAL')!);\n\n            await waitFor(() => expect(bodySelect('MODAL')).to.be.absent());\n        });\n    });\n\n    it('renders to the screen', async () => {\n        clientRenderer.render(<Modal isOpen={true} />);\n\n        await waitFor(() => expect(bodySelect('MODAL')!).to.be.present());\n    });\n\n    it('renders any children passed as props', async () => {\n        clientRenderer.render(\n            <Modal isOpen={true}>\n                <p data-automation-id=\"CHILD_1\">child 1</p>\n                <p data-automation-id=\"CHILD_2\">child 2</p>\n            </Modal>\n        );\n\n        await waitFor(() => {\n            expect(bodySelect('CHILD_1')).to.be.present();\n            expect(bodySelect('CHILD_2')).to.be.present();\n        });\n    });\n\n    it('takes the full width and height of the viewport and is centered in the viewport', async () => {\n        clientRenderer.render(<Modal isOpen={true} />);\n\n        function checkIfAlignedToScreen(element: Element) {\n            const rects = element.getBoundingClientRect();\n            return rects.top === 0 && rects.left === 0;\n        }\n\n        await waitFor(() => {\n            expect(checkIfAlignedToScreen(bodySelect('MODAL')!), 'The modal wasn\\'t centered').to.equal(true);\n            expect(bodySelect('MODAL')!.clientHeight).to.equal(window.innerHeight);\n            expect(bodySelect('MODAL')!.clientWidth).to.equal(window.innerWidth);\n        });\n    });\n\n    it('renders one child in the center of the viewport', async () => {\n        clientRenderer.render(\n            <Modal isOpen={true}>\n                <p data-automation-id=\"CHILD_1\" style={{width: '50px', height: '50px'}}>child 1</p>\n            </Modal>\n        );\n\n        await waitFor(() => {\n            const child = bodySelect('CHILD_1');\n            const modal = bodySelect('MODAL');\n            expect([child, modal]).to.be.horizontallyAligned('center', 1);\n            expect([child, modal]).to.be.verticallyAligned('center', 1);\n        });\n    });\n\n    it('renders children in horizontal alignment', async () => {\n        clientRenderer.render(\n            <Modal isOpen={true}>\n                <p data-automation-id=\"CHILD_1\" style={{width: '50px', height: '50px'}}>child 1</p>\n                <p data-automation-id=\"CHILD_2\" style={{width: '50px', height: '50px'}}>child 2</p>\n            </Modal>\n        );\n\n        await waitFor(() => {\n            const childOne = bodySelect('CHILD_1');\n            const childTwo = bodySelect('CHILD_2');\n            const modal = bodySelect('MODAL');\n            expect([childOne, childTwo, modal]).to.be.horizontallyAligned('center', 1);\n        });\n    });\n\n    it('adds overflow: hidden to the body when opened and removes it when closed', async () => {\n        const {container} = clientRenderer.render(<Modal isOpen={true} />);\n\n        await waitFor(() => expect(window.getComputedStyle(document.body).overflow).to.equal('hidden'));\n\n        clientRenderer.render(<Modal isOpen={false} />, container);\n\n        await waitFor(() => expect(window.getComputedStyle(document.body).overflow).to.not.equal('hidden'));\n\n        clientRenderer.render(<Modal isOpen={true} />, container);\n\n        await waitFor(() => expect(window.getComputedStyle(document.body).overflow).to.equal('hidden'));\n    });\n\n    it('appears aligned with the viewport even when the page was scrolled', async () => {\n        const scroll = document.createElement('div');\n        scroll.style.height = '1000vh';\n        scroll.style.width = '1000vw';\n        document.body.appendChild(scroll);\n        window.scrollTo(0, 2 * window.innerHeight);\n        clientRenderer.render(<Modal isOpen={true} />);\n\n        await waitFor(() => {\n            expect(bodySelect('MODAL')!.getBoundingClientRect().top).to.equal(0);\n        });\n\n        window.scrollTo(0, 0);\n        document.body.removeChild(scroll);\n    });\n\n    it('calls onRequestClose with source equal to backdrop when the backdrop is clicked', async () => {\n        const onRequestClose = sinon.spy();\n        clientRenderer.render(<Modal isOpen={true} onRequestClose={onRequestClose} />);\n\n        simulate.click(bodySelect('MODAL'));\n\n        await waitFor(() => expect(onRequestClose).to.have.been.calledWithMatch({source: 'backdrop'}));\n    });\n\n    it('calls onRequestClose with source equal to children when the child is clicked', async () => {\n        const onRequestClose = sinon.spy();\n\n        clientRenderer.render(\n            <Modal isOpen={true} onRequestClose={onRequestClose}>\n                <p data-slot=\"child\" data-automation-id=\"CHILD_1\">child 1</p>\n            </Modal>\n        );\n\n        simulate.click(bodySelect('CHILD_1'));\n\n        await waitFor(() => expect(onRequestClose.getCall(0)).to.have.been.calledWithMatch({source: 'child'}));\n    });\n\n    it('renders the modal to the bottom of the DOM', async () => {\n        const {container} = clientRenderer.render(\n            <Modal isOpen={true}>\n                <p data-automation-id=\"CHILD_1\">child 1</p>\n            </Modal>\n        );\n\n        await waitFor(() => {\n            const modal = bodySelect<HTMLElement>('MODAL')!;\n            const children = bodySelect<HTMLElement>('CHILD_1')!;\n\n            /* tslint:disable:no-bitwise */\n            expect(modal.compareDocumentPosition(children) & Node.DOCUMENT_POSITION_CONTAINED_BY,\n                'children contained in modal').to.equal(Node.DOCUMENT_POSITION_CONTAINED_BY);\n            expect(container.compareDocumentPosition(modal) & Node.DOCUMENT_POSITION_FOLLOWING,\n                'modal is following the app container').to.equal(Node.DOCUMENT_POSITION_FOLLOWING);\n            /* tslint:enable:no-bitwise */\n        });\n    });\n});\n"]}