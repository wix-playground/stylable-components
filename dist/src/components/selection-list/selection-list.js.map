{"version":3,"file":"selection-list.js","sourceRoot":"","sources":["../../../../src/components/selection-list/selection-list.tsx"],"names":[],"mappings":"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","sourcesContent":["import keycode = require('keycode');\nimport {autorun, computed, observable, untracked} from 'mobx';\nimport {observer} from 'mobx-react';\nimport React = require('react');\nimport {Disposers, properties} from 'wix-react-tools';\nimport {ChangeEvent} from '../../types/events';\nimport {FormInputProps} from '../../types/forms';\nimport {noop} from '../../utils';\nimport {OptionList, SelectionListItemValue, SelectionListModel} from './selection-list-model';\nimport {SelectionListView} from './selection-list-view';\n\nexport interface Props extends OptionList, FormInputProps<SelectionListItemValue> {\n    className?: string;\n    onChange?: (event: ChangeEvent<SelectionListItemValue>) => void;\n    style?: React.CSSProperties;\n    tabIndex?: number;\n    value?: SelectionListItemValue;\n}\n\n@observer\n@properties\nexport class SelectionList extends React.Component<Props> {\n    public static defaultProps: Props = {\n        onChange: noop,\n        tabIndex: -1\n    };\n\n    private disposers = new Disposers();\n    @observable private focused: boolean = false;\n\n    // Wrapping props with @computed allows to observe them independently from other props.\n    @computed public get children()   { return this.props.children; }\n    @computed public get dataSource() { return this.props.dataSource; }\n    @computed public get dataSchema() { return this.props.dataSchema; }\n    @computed public get renderItem() { return this.props.renderItem; }\n    @computed public get value()      { return this.props.value; }\n\n    @computed private get list(): SelectionListModel {\n        const list = new SelectionListModel();\n        list.addChildren(this.children);\n        list.addDataSource(this);\n        list.selectValue(untracked(() => this.value));\n        return list;\n    }\n\n    public componentWillMount() {\n        this.disposers.set(autorun(() => {\n            this.list.selectValue(this.value);\n        }));\n\n        this.disposers.set(autorun(() => {\n            this.list.focusValue(this.focused ? this.value : undefined);\n        }));\n    }\n\n    public componentWillUnmount() {\n        this.disposers.disposeAll();\n    }\n\n    public render() {\n        return (\n            <SelectionListView\n                focused={this.focused}\n                list={this.list}\n                onBlur={this.handleBlur}\n                onChange={this.props.onChange}\n                onFocus={this.handleFocus}\n                onKeyDown={this.handleKeyDown}\n                style={this.props.style}\n                tabIndex={this.props.tabIndex}\n            />\n        );\n    }\n\n    private handleFocus: React.FocusEventHandler<HTMLElement> = () => {\n        this.focused = true;\n    }\n\n    private handleBlur: React.FocusEventHandler<HTMLElement> = () => {\n        this.focused = false;\n    }\n\n    private handleKeyDown: React.KeyboardEventHandler<HTMLElement> = event => {\n        switch (event.keyCode) {\n            case keycode('enter'):\n            case keycode('space'):\n                event.preventDefault();\n                const focusedValue = this.list.getFocusedValue();\n                if (focusedValue !== undefined) {\n                    this.props.onChange!({value: focusedValue});\n                }\n                break;\n\n            case keycode('up'):\n                event.preventDefault();\n                this.list.focusPrevious();\n                break;\n\n            case keycode('down'):\n                event.preventDefault();\n                this.list.focusNext();\n                break;\n\n            case keycode('home'):\n                event.preventDefault();\n                this.list.focusFirst();\n                break;\n\n            case keycode('end'):\n                event.preventDefault();\n                this.list.focusLast();\n                break;\n        }\n    }\n}\n"]}