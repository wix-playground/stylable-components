{"version":3,"file":"image.js","sourceRoot":"","sources":["../../../../src/components/image/image.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {noop, transparentImage} from '../../utils';\n\nexport interface ImageEvent extends React.SyntheticEvent<HTMLImageElement> {\n    src: string;\n}\n\nexport interface ImageProps extends React.HTMLAttributes<HTMLImageElement> {\n    src?: string;\n    alt?: string;\n    title?: string;\n    resizeMode?: 'fill' | 'cover' | 'contain';\n\n    onLoad?: (event: ImageEvent) => void;\n    onError?: (event: ImageEvent) => void;\n    defaultImage?: string;\n}\n\nexport interface ImageState {\n    src: string;\n}\n\nconst hiddenImageStyle = {\n    display: 'block',\n    maxWidth: '100%',\n    height: '100%',\n    visibility: 'hidden'\n};\n\nconst staticWrapperStyle = {\n    display: 'inline-block',\n    backgroundPosition: 'center',\n    backgroundRepeat: 'no-repeat'\n};\n\nexport class Image extends React.PureComponent<ImageProps, ImageState> {\n    public static defaultProps: Partial<ImageProps> = {\n        defaultImage: transparentImage,\n        onLoad: noop,\n        onError: noop\n    };\n\n    public render() {\n        const {\n            // these two are always set on the root\n            style,\n            className,\n\n            // shouldn't be printed to DOM\n            defaultImage,\n            resizeMode,\n\n            ...rest\n        } = this.props;\n\n        // 'fill' is the default image behavior, so no need to put it on background\n        if (resizeMode === 'contain' || resizeMode === 'cover') {\n            const wrapperStyle = {\n                ...staticWrapperStyle,\n                backgroundImage: `url(\"${this.state.src}\")`,\n                backgroundSize: resizeMode,\n                ...style\n            };\n            return (\n                <div style={wrapperStyle} className={className} >\n                    <img\n                        data-automation-id=\"NATIVE_IMAGE\"\n                        {...rest}\n                        style={hiddenImageStyle}\n                        src={this.state.src}\n                        onLoad={this.onLoad}\n                        onError={this.onError}\n                    />\n                </div>\n            );\n        }\n\n        return (\n            <img\n                data-automation-id=\"NATIVE_IMAGE\"\n                {...rest}\n                style={{display: 'inline-block', ...style}}\n                className={className}\n                src={this.state.src}\n                onLoad={this.onLoad}\n                onError={this.onError}\n            />\n        );\n    }\n    public componentWillMount() {\n        this.setState({src: this.props.src || this.props.defaultImage!});\n    }\n\n    public componentWillReceiveProps(newProps: ImageProps) {\n        this.setState({src: newProps.src || this.props.defaultImage!});\n    }\n\n    private onError: React.EventHandler<React.SyntheticEvent<HTMLImageElement>> = e => {\n        this.props.onError!({...e, src: this.state.src});\n        this.setState({src: this.getFallbackSrcFor(this.state.src)});\n    }\n\n    private onLoad: React.EventHandler<React.SyntheticEvent<HTMLImageElement>> = e => {\n        if (this.state.src !== this.props.defaultImage && this.state.src !== transparentImage) {\n            this.props.onLoad!({...e, src: this.state.src});\n        }\n    }\n\n    private getFallbackSrcFor(src: string): string {\n        // first, fallback to defaultImage, and later to one transparent pixel\n        return (src !== this.props.defaultImage) ? this.props.defaultImage! : transparentImage;\n    }\n}\n"]}