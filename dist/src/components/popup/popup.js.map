{"version":3,"file":"popup.js","sourceRoot":"","sources":["../../../../src/components/popup/popup.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {properties} from 'wix-react-tools';\nimport {Point} from '../../types';\nimport {Portal} from '../portal';\n\nexport type PopupVerticalPosition =  'top' | 'center' | 'bottom';\nexport type PopupHorizontalPosition = 'left' | 'center' | 'right';\n\nexport interface PopupPositionPoint {\n    vertical: PopupVerticalPosition;\n    horizontal: PopupHorizontalPosition;\n}\n\nexport interface PopupProps extends properties.Props {\n    open?: boolean;\n    anchorPosition?: PopupPositionPoint;\n    popupPosition?: PopupPositionPoint;\n    syncWidth?: boolean;\n    maxHeight?: number;\n    children?: React.ReactNode;\n}\n\nexport interface PopupCompProps extends PopupProps {\n    anchor: Element | Point | null;\n}\n\n@properties\nexport class Popup extends React.Component<PopupCompProps> {\n    public static defaultProps: Partial<PopupCompProps> = {\n        open: false,\n        anchorPosition: {vertical: 'bottom', horizontal: 'left'},\n        popupPosition: {vertical: 'top', horizontal: 'left'},\n        syncWidth: true,\n        maxHeight: 500\n    };\n\n    public render() {\n        if (this.props.anchor && this.props.open) {\n            return (\n                <Portal style={this.createStyle()}>\n                    {this.props.children}\n                </Portal>);\n        }\n\n        return null;\n    }\n\n    private createStyle(): React.CSSProperties {\n        if (!this.props.anchor) {\n            return {};\n        }\n        const newStyle: React.CSSProperties = {position: 'absolute'};\n\n        newStyle.maxHeight = this.props.maxHeight;\n        newStyle.transform = '';\n        newStyle.WebkitTransform = '';\n        if (isPoint(this.props.anchor)) {\n            newStyle.top = this.props.anchor.y;\n            newStyle.left = this.props.anchor.x;\n\n        } else {\n            const anchorRect = this.props.anchor!.getBoundingClientRect();\n            if (this.props.syncWidth) {\n                newStyle.width = anchorRect.width;\n            }\n\n            newStyle.top = getVerticalReference(anchorRect, this.props.anchorPosition!.vertical);\n            newStyle.left = getHorizontalReference(anchorRect, this.props.anchorPosition!.horizontal);\n        }\n        switch (this.props.popupPosition!.vertical) {\n            case 'center':\n                addTransform(newStyle, 'translateY(-50%)');\n                break;\n            case 'bottom':\n                addTransform(newStyle, 'translateY(-100%)');\n                break;\n        }\n        switch (this.props.popupPosition!.horizontal) {\n            case 'center':\n                addTransform(newStyle, 'translateX(-50%)');\n                break;\n            case 'right':\n                addTransform(newStyle, 'translateX(-100%)');\n                break;\n        }\n\n        return newStyle;\n    }\n}\n\nfunction getVerticalReference(rect: ClientRect, anchorPosition: PopupVerticalPosition): number {\n    if (anchorPosition === 'center') {\n        return window.pageYOffset + rect.top + (rect.height / 2);\n    } else {\n        return window.pageYOffset + rect[anchorPosition as 'top' | 'bottom'];\n    }\n}\n\nfunction getHorizontalReference(rect: ClientRect, anchorPosition: PopupHorizontalPosition): number {\n    if (anchorPosition === 'center') {\n        return window.pageXOffset + rect.left + (rect.width / 2);\n    } else {\n        return window.pageXOffset + rect[anchorPosition as 'left' | 'right'];\n    }\n}\n\nfunction addTransform(style: React.CSSProperties, transformation: string) {\n    style.transform += transformation;\n    style.WebkitTransform += transformation;\n}\n\nfunction isPoint(elem: Element | Point): elem is Point {\n    return elem.hasOwnProperty('x') && elem.hasOwnProperty('y');\n}\n"]}